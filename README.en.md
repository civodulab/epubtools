# EpubTools README (_not updated_)

[![Licence](https://img.shields.io/github/license/civodulab/epubtools.svg)](https://github.com/civodulab/epubtools)
[![VS Code Marketplace](https://vsmarketplacebadge.apphb.com/version-short/civodulab.epubtools.svg) ![Rating](https://vsmarketplacebadge.apphb.com/rating-short/civodulab.epubtools.svg) ![Installs](https://vsmarketplacebadge.apphb.com/installs/civodulab.epubtools.svg)](https://marketplace.visualstudio.com/items?itemName=civodulab.epubtools)

Tools to facilitate work on EPUBs.



## Important

The EPUB file must be uncompressed. Then you can work in his directories.

----------

## EpubTools contents (`ctrl+shift+P`)

- `EpubTools: Creation Page List`
  >  Retrieves tags with the `epub:type="pagebreak"` attribute. Creates or modifies `<nav epub:type="page-list">` in the table of contents file `(toc).xhtml`.

- `EpubTools: A11Y`
  > Open a list of tools to improve accessibility (a11y):
  > - `DPub-Aria roles` : Add _role="doc-`X`"_ in markup if _epub:type="`X`"_ is in it  (I was helped by the scripts from [JayPanoz](https://gist.github.com/JayPanoz/45896f17a69892de9a121d701c578d1e) et de [rodebert](https://gist.github.com/rodebert/81837a2676cf2c04819a582c3eb49c13))  
  > Reference: [Digital Publishing WAI-ARIA Module 1.0](https://www.w3.org/TR/dpub-aria-1.0/)

- `EpubTools: Table of contents`
  > Modify files containing a table of contents `(toc).xhtml` or/and `(toc).ncx` using the `spine` of the `opf`.

- `EpubTools: Manifest`
  > Rebuilds the manifest in the OPF according to the files in the EPUB. The command must be launched in the `.opf` file.

- `EpubTools: Problems?`
  >  Displays problems in the `OUTPUT` tab:
  >- Pages without `<h>`
  >- Bad hierarchy of titles  (e.g., `h1` followed by `h3` without `h2` between them).
  >- Issues with `<spine>` if `idref` in `<itemref>` are missing in the `<manifest>`

- `EpubTools: first <h.> => <title>`
  > Copy the first title (if any) of each `xhtml` page into the`<title>`tag of that page.

- `EpubTools : <span...>{numPage}</span> => <span {epub:type} />`

  >  Converts...
  > ```xhtml
  > <span class="epubTools-numPage-style">{number}</span>
  > ```
  > ... to
  > ```xhtml
  >  <span id="page{number}" title="{number}" epub:type="pagebreak" role="doc-pagebreak"></span>
  >  ```
    >  _**Tip:** Use InDesign script [epubTools-numPage](https://github.com/civodulab/epubTools-numPage) before export EPUB from InDesign._
----------

## EpubTools Configuration (`ctrl+,`)
- `epub.activerA11ylint`
  > Activate _a11ylint_ (default **true**)

- `epub.ancreTDM`
  - `ajouterAncre` (_add anchor_): boolean  (default: **true**)
  - `nomAncre`: prefix's name of the anchor (default: **toc-epubtools**)

- `epub.classeTDM`
  > CSS class applied to the `<ol>` tag in the TOC (default: **ol-toc**)

- `epub.coverImage`
  > Name of the file of the cover image (add _properties="**cover-image**"_ to this image in `<manifest>` - default **cover**)

- `epub.emphaseStyleAChercher` ([A11yLint](#a11ylint))
  > Text strings in CSS class names on `<span>` to check with A11yLint.
  > - `italique` (défaut **["italique","italic"]**)
  > - `gras` (défaut **["bold", "gras", "strong"]**)
  > - `emphase` (défaut **["emphase", "emphasis"]**)
  >
  > e.g.: `<span class="fancy-italic">` will trigger an alert with a11yLint.

- `epub.emphaseStyleAEviter` ([A11yLint](#a11ylint))
  > Text strings to avoid in CSS class names on `<span>` with `epub.emphaseStyleAChercher` (default **["no-bold", "no-italique","no-emphase"]**)
  >
  > e.g.: `<span class="no-bold-italic">` will NOT trigger an alert with a11yLint.

- `epub.navTDM`
  > Name of the TOC file (Allow to add  _properties="**nav**"_ to the TOC `<item>` in `<manifest>` - défaut : **toc**)

- `epub.niveauTitre`
    > Maximum titles level in the TOC generated by _`EpubTools: Table of contents`_ (default: **3**)  

- `epub.titreTDM` ('title' of the TOC)
  - `titre`: Text title of the TOC (default: **Table des matières**)
  - `balise`: HTML Tag for the title (default: **h1**)
  - `classe`: CSS class for the title (default: **titre1**)

* * *

## A11yLint

- Display issues with `<img>`:
  - if `alt` is empty
  - if `alt` is missing
- Check if `<span>` with class italic, bold, etc. => change to `<em>` ?
- Check `noteref` in `<sup>` => remove `<sup>...</sup>`
- `aria-label` and `controls` checking in `<audio>` and `<video>` tags.